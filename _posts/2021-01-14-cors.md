---
title: "CORS(Cross Origin Resource Sharing)"
search: false
category:
  - information
last_modified_at: 2021-08-21T17:00:00
---

<br>

ğŸ‘‰ ì´ì–´ì„œ ì½ê¸°ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.
- [CORS(Cross Origin Resource Sharing) ì„œë²„ êµ¬í˜„][cors-server-example-link]
- [ë¦¬ì•¡íŠ¸(React) CORS í•´ê²°í•˜ê¸° (feat. í”„ë¡ì‹œ(Proxy) êµ¬ì¶•)][react-proxy-link]

## 0. ë“¤ì–´ê°€ë©´ì„œ

ìµœê·¼ ê°œë°œ ì¶”ì„¸ì¸ SPA(Single Page Application) ê°œë°œì‹œ ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œì…ë‹ˆë‹¤. 
ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì™¸ë¶€ ì„œë²„ì˜ ê²½ë¡œë¡œ AJAX ìš”ì²­ ì‹œ ë¸Œë¼ìš°ì €ì—ì„œ ì—ëŸ¬ë¥¼ ë‚´ëŠ” í˜„ìƒì…ë‹ˆë‹¤. 
ìš°ì„  CORS ë¬¸ì œë¥¼ ì‚´í´ë³´ê¸° ì „ì— ë™ì¼ ì¶œì²˜ ì •ì±…(Same-Origin Policy)ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## 1. ë™ì¼ ì¶œì²˜ ì •ì±… (Same-Origin Policy)

> ë™ì¼ ì¶œì²˜ ì •ì±…(same-origin policy)ì€ ì–´ë–¤ ì¶œì²˜ì—ì„œ ë¶ˆëŸ¬ì˜¨ ë¬¸ì„œë‚˜ ìŠ¤í¬ë¦½íŠ¸ê°€ ë‹¤ë¥¸ ì¶œì²˜ì—ì„œ ê°€ì ¸ì˜¨ ë¦¬ì†ŒìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ê²ƒì„ ì œí•œí•˜ëŠ” ì¤‘ìš”í•œ ë³´ì•ˆ ë°©ì‹ì…ë‹ˆë‹¤. 
> ë™ì¼ ì¶œì²˜ ì •ì±…ì€ ì ì¬ì ìœ¼ë¡œ í•´ë¡œìš¸ ìˆ˜ ìˆëŠ” ë¬¸ì„œë¥¼ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ ê³µê²©ë°›ì„ ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ì¤„ì—¬ì¤ë‹ˆë‹¤. -MDN Web Docs

ë‘ URLì˜ **í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸, í¬íŠ¸**ê°€ ëª¨ë‘ ê°™ì•„ì•¼ ë™ì¼í•œ ì¶œì²˜ë¼ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
ì•„ë˜ ì´ë¯¸ì§€ì²˜ëŸ¼ **http://domain-a.com/** ì—ì„œ **http://domain-a.com/** ì„œë²„ë¡œì˜ ìš”ì²­ì€ **same-origin**, **http://domain-b.com/** ì„œë²„ë¡œì˜ ìš”ì²­ì€ **cross-origin** ì…ë‹ˆë‹¤. 
same-origin ì„œë²„ë¡œì˜ ìš”ì²­ì€ ì •ìƒì ì¸ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆì§€ë§Œ cross-origin ì„œë²„ë¡œì˜ ìš”ì²­ì€ ì‘ë‹µë°›ëŠ” í—¤ë” ì •ë³´ì— ë”°ë¼ ì •ìƒì ì´ê±°ë‚˜ ì•„ë‹ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

<p align="center"><img src="/images/cors-1.JPG" width="60%"></p>
<center>https://developer.mozilla.org/ko/docs/Web/HTTP/CORS</center><br>

ì•„ë˜ í‘œëŠ” ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ http://store.company.com (ê¸°ë³¸ í¬íŠ¸, 80) í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸, í¬íŠ¸ ì •ë³´ë¥¼ ê°€ì§ˆ ë•Œ ë™ì¼ ì¶œì²˜ ì •ì±… ìƒì—ì„œ ìš”ì²­ì˜ ì„±ê³µ ì—¬ë¶€ì…ë‹ˆë‹¤.

| URL | ê²°ê³¼ | ì´ìœ  |
|---|:---:|:---|
| http://store.company.com/dir2/other.html | ì„±ê³µ | ê²½ë¡œë§Œ ë‹¤ë¦„ |
| http://store.company.com/dir/inner/another.html | ì„±ê³µ | ê²½ë¡œë§Œ ë‹¤ë¦„ |
| https://store.company.com/secure.html | ì‹¤íŒ¨ | í”„ë¡œí† ì½œ ë‹¤ë¦„ |
| http://store.company.com:81/dir/etc.html | ì‹¤íŒ¨ | í¬íŠ¸ ë‹¤ë¦„ (http://ëŠ” 80ì´ ê¸°ë³¸ê°’) |
| http://news.company.com/dir/other.html | ì‹¤íŒ¨ | í˜¸ìŠ¤íŠ¸ ë‹¤ë¦„ |

## 2. êµì°¨ ì¶œì²˜ ìì› ê³µìœ  (CORS, Cross Origin Resource Sharing)

> êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ (Cross-Origin Resource Sharing, CORS)ëŠ” ì¶”ê°€ HTTP í—¤ë”ë¥¼ ì‚¬ìš©í•˜ì—¬, 
> í•œ ì¶œì²˜ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¤ë¥¸ ì¶œì²˜ì˜ ì„ íƒí•œ ìì›ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì„ ë¶€ì—¬í•˜ë„ë¡ ë¸Œë¼ìš°ì €ì— ì•Œë ¤ì£¼ëŠ” ì²´ì œì…ë‹ˆë‹¤. -MDN Web Docs

ë™ì¼ ì¶œì²˜ ì •ì±…ì— ëŒ€í•œ ë¶ˆí¸í•¨ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë“±ì¥í•œ ì •ì±…ì…ë‹ˆë‹¤. 
ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì™¸ë¶€ ë„ë©”ì¸ ì„œë²„ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ ë°©ì‹ì„ í‘œì¤€í™”í•œ ìŠ¤í™ì…ë‹ˆë‹¤. 
APIë¥¼ ì‚¬ìš©í•˜ëŠ” ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ìì‹ ì˜ ì¶œì²˜ì™€ ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë§Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìœ¼ë©°, **ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë¶ˆëŸ¬ì˜¤ë ¤ë©´ ê·¸ ì¶œì²˜ì—ì„œ ì˜¬ë°”ë¥¸ CORS í—¤ë”ë¥¼ í¬í•¨í•œ ì‘ë‹µì„ ë°˜í™˜ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.** 
ì•„ë˜ CORS ì‘ë™ ë°©ì‹ì„ í†µí•´ ì¡°ê¸ˆ ë” ìì„¸íˆ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. 

## 3. CORS ì‘ë™ ë°©ì‹
### 3.1. ë‹¨ìˆœ ìš”ì²­ (Simple requests)
ì¼ë¶€ ìš”ì²­ì€ CORS preflight íŠ¸ë¦¬ê±°ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 
ì´ëŸ° ë‹¨ìˆœ ìš”ì²­ì€ ì•„ë˜ ì¡°ê±´ë“¤ì„ ë§Œì¡±í•´ì•¼ í•©ë‹ˆë‹¤.<br>
(ì¼ë¶€ë§Œ ì •ë¦¬í•˜ì˜€ìœ¼ë©° êµ¬ì²´ì ì¸ ë‚´ìš©ì€ [MDN Web Docs - CORS][cors-web-docs-link])
- ë©”ì†Œë“œ
    - GET
    - HEAD
    - POST
- í—ˆìš©ë˜ëŠ” Content-Type í—¤ë”
    - application/x-www-form-urlencoded
    - multipart/form-data
    - text/plain
- ìœ ì € ì—ì´ì „íŠ¸ê°€ ìë™ìœ¼ë¡œ ì„¤ì •í•œ í—¤ë” ì™¸ì— í—ˆìš©ë˜ëŠ” í—¤ë”
    - Accept
    - Accept-Language
    - Content-Language
    - Content-Type
    - DPR
    - Downlink
    - Save-Data
    - Viewport-Width
    - Width

- https://foo.example ë„ë©”ì¸ì˜ ì›¹ ì»¨í…ì¸ ê°€ https://bar.other ë„ë©”ì¸ì˜ ì»¨í…ì¸ ë¥¼ ë‹¨ìˆœ í˜¸ì¶œ
    - í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ê°„ì— ê°„ë‹¨í•œ í†µì‹ ì„ í•˜ê³ , CORS í—¤ë”ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¶Œí•œì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.
    - ì‘ë‹µ í—¤ë”ë¡œ __Access-Control-Allow-Origin: *__ ë¥¼ ì „ë‹¬ë°›ëŠ”ë° ì´ëŠ” ëª¨ë“  ë„ë©”ì¸ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
    - íŠ¹ì • ë„ë©”ì¸ì˜ ìš”ì²­ë§Œ í—ˆìš©í•˜ë ¤ë©´ **Access-Control-Allow-Origin: https://foo.example** ì™€ ê°™ì€ ë°©ì‹ì˜ ì‘ë‹µ í—¤ë”ê°€ í•„ìš”í•©ë‹ˆë‹¤.

<p align="center"><img src="/images/cors-2.JPG" width="60%"></p>
<center>https://developer.mozilla.org/ko/docs/Web/HTTP/CORS</center><br>

- ë‹¨ìˆœ ìš”ì²­
> GET /resources/public-data/ HTTP/1.1<br>
> Host: bar.other<br>
> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko/20100101 Firefox/71.0<br>
> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br>
> Accept-Language: en-us,en;q=0.5<br>
> Accept-Encoding: gzip,deflate<br>
> Connection: keep-alive<br>
> Origin: https://foo.example<br>

- ë‹¨ìˆœ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ
> HTTP/1.1 200 OK<br>
> Date: Mon, 01 Dec 2008 00:23:53 GMT<br>
> Server: Apache/2<br>
> __Access-Control-Allow-Origin: *__<br>
> Keep-Alive: timeout=2, max=100<br>
> Connection: Keep-Alive<br>
> Transfer-Encoding: chunked<br>
> Content-Type: application/xml<br>
> <br>
> [â€¦XML Dataâ€¦]<br>

### 3.2. í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ (Preflight requests)
ë‹¨ìˆœ ìš”ì²­ê³¼ ë‹¬ë¦¬ ë¨¼ì € OPTIONS ë©”ì†Œë“œë¥¼ í†µí•´ ë‹¤ë¥¸ ë„ë©”ì¸ì˜ ë¦¬ì†ŒìŠ¤ë¡œ HTTP ìš”ì²­ì„ ë³´ë‚´ ì‹¤ì œ ìš”ì²­ì´ ì „ì†¡í•˜ê¸°ì— ì•ˆì „í•œì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. 
cross-site ìš”ì²­ì€ ìœ ì € ë°ì´í„°ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¯¸ë¦¬ ì „ì†¡(preflighted)í•´ë³´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

- https://foo.example ë„ë©”ì¸ì˜ ì›¹ ì»¨í…ì¸ ê°€ https://bar.other ë„ë©”ì¸ì˜ ì»¨í…ì¸ ë¥¼ Preflight í˜¸ì¶œ
    - Preflight ìš”ì²­ì„ ì „ì†¡í•©ë‹ˆë‹¤.(Preflight request)
    - ì´ì— ëŒ€í•œ ì‘ë‹µì„ ë°›ì€ í›„ ì‹¤ì œ ìš”ì²­ì„ ì „ë‹¬í•©ë‹ˆë‹¤.(Main request)
    - Preflight ìš”ì²­ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        - Access-Control-Request-Method: POST (ì‹¤ì œ ìš”ì²­ì—ì„œ ì‚¬ìš©í•  ë©”ì†Œë“œ)
        - Access-Control-Request-Headers: X-PINGOTHER, Content-Type (ì‹¤ì œ ìš”ì²­ì—ì„œ ì‚¬ìš©í•  í—¤ë” ì •ë³´)
    - Preflight ì‘ë‹µì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        - Access-Control-Allow-Origin: https://foo.example (https://foo.example ë„ë©”ì¸ì˜ ìš”ì²­ë§Œ í—ˆìš©)
        - Access-Control-Allow-Methods: POST, GET, OPTIONS (í—ˆìš©ë˜ëŠ” ë©”ì†Œë“œ)
        - Access-Control-Allow-Headers: X-PINGOTHER, Content-Type (í—ˆìš©ë˜ëŠ” í—¤ë” ì •ë³´)
        - Access-Control-Max-Age: 86400 (preflight ìš”ì²­ ê²°ê³¼ë¥¼ ìºì‹œí•  ìˆ˜ ìˆëŠ” ì‹œê°„)
    
<p align="center"><img src="/images/cors-3.JPG" width="60%"></p>
<center>https://developer.mozilla.org/ko/docs/Web/HTTP/CORS</center><br>

- Preflight ìš”ì²­
> OPTIONS /resources/post-here/ HTTP/1.1<br>
> Host: bar.other<br>
> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko/20100101 Firefox/71.0<br>
> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br>
> Accept-Language: en-us,en;q=0.5<br>
> Accept-Encoding: gzip,deflate<br>
> Connection: keep-alive<br>
> Origin: http://foo.example<br>
> __Access-Control-Request-Method: POST__<br>
> __Access-Control-Request-Headers: X-PINGOTHER, Content-Type__<br>

- Preflight ì‘ë‹µ
> HTTP/1.1 204 No Content<br>
> Date: Mon, 01 Dec 2008 01:15:39 GMT<br>
> Server: Apache/2<br>
> __Access-Control-Allow-Origin: https://foo.example__<br>
> __Access-Control-Allow-Methods: POST, GET, OPTIONS__<br>
> __Access-Control-Allow-Headers: X-PINGOTHER, Content-Type__<br>
> __Access-Control-Max-Age: 86400__<br>
> Vary: Accept-Encoding, Origin<br>
> Keep-Alive: timeout=2, max=100<br>
> Connection: Keep-Alive<br>

#### REFERENCE
- <https://brunch.co.kr/@adrenalinee31/1>
- <https://developer.mozilla.org/ko/docs/Web/Security/Same-origin_policy>
- <https://developer.mozilla.org/ko/docs/Web/HTTP/CORS>

[cors-web-docs-link]: https://developer.mozilla.org/ko/docs/Web/HTTP/CORS

[cors-server-example-link]: https://junhyunny.github.io/spring-boot/vue.js/cors-example/
[react-proxy-link]: https://junhyunny.github.io/information/react/react-proxy/