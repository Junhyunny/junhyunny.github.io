---
title: "Precautions Moment Timezone API"
search: false
category:
  - typescript
last_modified_at: 2022-12-29T23:55:00
---

<br>

#### RECOMMEND POSTS BEFORE THIS

* [GMT and UTC][gmt-and-utc-link]
* [Handling Timezone on JavaScript][handling-timezone-on-javascript-link]

## 0. 들어가면서

타임존(timezone) 비즈니스를 다루기 위해 `moment-timezone` 라이브러리를 사용하면서 겪은 경험들을 정리하였습니다. 
API가 익숙치 않은 탓에 어플리케이션 곳곳에 버그들이 숨어 있었습니다. 
사용할 때 신경 써야하는 부분들은 어떤 것들이 있는지 살펴보겠습니다. 

## 1. Use now method of Date Class in Moment

다음 테스트는 실패해야하지만, 정상적으로 통과합니다.

* 테스트 코드 중간에서 일부러 반복문 코드를 수행합니다.
* 
* `beforeEach`에서 Date 클래스의 now 메소드를 

```ts
import moment from "moment-timezone";

describe("moment timezone tests", () => {
  beforeEach(() => {
    const now = Date.now();
    jest.spyOn(Date, "now").mockReturnValue(now);
  });

  it("mock now method in Date class", () => {
    const firstValue = moment.now();

    for (let index = 0; index < 10000000; index++) {}

    const secondValue = moment.now();
    expect(firstValue).toEqual(secondValue);
  });
});
```








## CLOSING

#### TEST CODE REPOSITORY

#### RECOMMEND NEXT POSTS

#### REFERENCE

[gmt-and-utc-link]: https://junhyunny.github.io/information/gmt-and-utc/
[handling-timezone-on-javascript-link]: https://junhyunny.github.io/javascript/handling-timezone-on-javascript/