---
title: "JPA Flush"
search: false
category:
  - spring-boot
  - jpa
  - junit
last_modified_at: 2021-08-22T01:30:00
---

<br>

ğŸ‘‰ í•´ë‹¹ í¬ìŠ¤íŠ¸ë¥¼ ì½ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.
- [JPA(Java Persistence API)][java-persistence-api-link]
- [PersistenceContext and Entity Lifecycle][jpa-persistence-context-link]
- [Features of EntityManager][persistence-context-advantages-link]

ğŸ‘‰ ì´ì–´ì„œ ì½ê¸°ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.
- [JPA Clear][jpa-clear-link]

## 0. ë“¤ì–´ê°€ë©´ì„œ

> ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(Persistence Context)ì— ì¡´ì¬í•˜ëŠ” ì—”í‹°í‹°(Entity) ë³€ê²½ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë™ê¸°í™”í•˜ëŠ” ì‘ì—…

JPAì—ì„œ flushê°€ ë™ì‘í•˜ëŠ” ì‹œì ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
- ëª…ì‹œì ìœ¼ë¡œ entityManager.flush() ë©”ì†Œë“œ í˜¸ì¶œ
- entityManager.getTransaction().commit() ë©”ì†Œë“œ í˜¸ì¶œ
- JPQL ì¿¼ë¦¬ ìˆ˜í–‰ì‹œ ìë™ìœ¼ë¡œ ìˆ˜í–‰(**`FlushModeType.AUTO`**ì¸ ê²½ìš°ì—ë§Œ ì ìš©)

ëª…ì‹œì ì¸ í˜¸ì¶œì´ë‚˜ commit ì‹œì ì— ë™ì‘í•˜ëŠ” ê²ƒì€ ì–´ë µì§€ ì•Šê²Œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
ê·¸ëŸ°ë° JPQLì€ ë¬´ì—‡ì´ê³ , **`FlushModeType.AUTO`**ì¸ ê²½ìš°ì—ë§Œ ì ìš©ëœë‹¤ëŠ” ë§ì€ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤. 
ê´€ë ¨ ë‚´ìš©ë“¤ì„ ì¡°ê¸ˆ ë” ìì„¸íˆ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.

## 1. Flush ëª¨ë“œ ì˜µì…˜

> JPA flush ê¸°ëŠ¥ì´ ìˆ˜í–‰ë˜ëŠ” ì‹œì ì„ ê²°ì •í•˜ëŠ” ì˜µì…˜

ë‹¤ìŒê³¼ ê°™ì€ ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤.
- FlushModeType.AUTO, ë””í´íŠ¸(default) ê°’ìœ¼ë¡œ commit ë˜ëŠ” JQPL ì¿¼ë¦¬ ì‹¤í–‰ì‹œ flush ê¸°ëŠ¥ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.
- FlushModeType.COMMIT, commit ì‹œì ì—ë§Œ flush ê¸°ëŠ¥ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.(ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©)

## 2. JPQL(Java Persistence Query Language)

> JPAì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ ì§€í–¥ì  ì¿¼ë¦¬(Query)

JPQLì€ í…Œì´ë¸”ì„ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—”í‹°í‹° ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì¿¼ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì¼ë°˜ì ì¸ SQLê³¼ ì¡°ê¸ˆ ë‹¤ë¥¸ ë¬¸ë²• ìš”ì†Œë¥¼ ê°€ì§‘ë‹ˆë‹¤. 
JPQLì— ëŒ€í•œ ì •ë¦¬ ê¸€ì´ ì•„ë‹ˆë‹ˆ ê°„ë‹¨íˆ ê°œë…ì— ëŒ€í•´ì„œë§Œ ì •ë¦¬í•˜ê³  JPA flush ë©”ì†Œë“œì™€ ì–´ë–¤ ì—°ê´€ì´ ìˆëŠ”ì§€ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. 

~~**JPQLì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì˜í•´ ê´€ë¦¬ë˜ê³  ìˆëŠ” ë°ì´í„°ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê³  ë™ì‘í•©ë‹ˆë‹¤.**~~([JPA Clear][jpa-clear-link]) 
ê·¸ë ‡ê¸° ë•Œë¬¸ì— JPQL ì‚¬ìš© ì‹œ flush ëª¨ë“œ ì˜µì…˜ ê°’ì— ë”°ë¼ ê°™ì€ ì½”ë“œê°€ ì„œë¡œ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤. 
**`FlushModeType.COMMIT` ì˜µì…˜ ì‚¬ìš© ì‹œ JPQL ì¿¼ë¦¬ ìˆ˜í–‰ ì „ ë°˜ë“œì‹œ flush ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ëœ ë°ì´í„°ì™€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë™ê¸°í™”í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.**

## 3. í…ŒìŠ¤íŠ¸ ì½”ë“œ
ì•„ë˜ì™€ ê°™ì€ ê´€ì ì—ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. 
- **`FlushModeType.AUTO`** ì˜µì…˜ ì‚¬ìš© ì‹œ JPQL ì¿¼ë¦¬ ì‚¬ìš© ì „ì— flush ê¸°ëŠ¥ì´ ë™ì‘ë˜ì—ˆëŠ”ê°€?
- **`FlushModeType.COMMIT`** ì˜µì…˜ ì‚¬ìš© ì‹œ JPQL ì¿¼ë¦¬ ì‚¬ìš© ì „ì— flush ê¸°ëŠ¥ì´ ë™ì‘ë˜ì—ˆëŠ”ê°€? 

í…ŒìŠ¤íŠ¸ ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìœ¼ë©° ë°ì´í„°ê°€ ê°™ì€ ê²°ê³¼ë¥¼ ê°–ëŠ”ì§€ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
- flush ë©”ì†Œë“œ ë‚´ë¶€ì ìœ¼ë¡œ ë™ì‘í•˜ì˜€ëŠ”ì§€ ì¿¼ë¦¬ë¥¼ JQPL ì¿¼ë¦¬ ì‚¬ìš© ì „, í›„ì— ë¡œê·¸ë¥¼ ë‚¨ê²¨ í™•ì¸í•©ë‹ˆë‹¤.
- MEMBER ê¶Œí•œì„ ê°€ì§„ ë°ì´í„°ë“¤ì„ JPQL_MEMBER ê¶Œí•œìœ¼ë¡œ ë³€ê²½í•œ í›„ JPQL_MEMBER ê¶Œí•œì„ ê°€ì§„ ë©¤ë²„ê°€ 1ëª… ì´ìƒì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.

### 3.1. **`FlushModeType.AUTO`** ì˜µì…˜ ì‚¬ìš© í…ŒìŠ¤íŠ¸

```java
package blog.in.action.flush;

import static org.junit.jupiter.api.Assertions.assertTrue;
import blog.in.action.entity.Member;
import java.util.ArrayList;
import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.FlushModeType;
import javax.persistence.PersistenceUnit;
import javax.persistence.TypedQuery;
import lombok.extern.log4j.Log4j2;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@Log4j2
@SpringBootTest
public class AutoOptionTest {

    @PersistenceUnit
    private EntityManagerFactory factory;

    @BeforeEach
    private void beforeEach() {
        EntityManager em = factory.createEntityManager();
        try {
            em.getTransaction().begin();
            Member member = em.find(Member.class, "01012341234");
            if (member == null) {
                member = new Member();
                member.setId("01012341234");
                member.setPassword("1234");
                member.setMemberName("Junhyunny");
                member.setMemberEmail("kang3966@naver.com");
                em.persist(member);
            } else {
                member.setAuthorities(new ArrayList<>());
            }
            em.getTransaction().commit();
        } catch (Exception ex) {
            em.getTransaction().rollback();
            log.error("exception occurs", ex);
        } finally {
            em.close();
        }
    }

    @Test
    public void test() {
        EntityManager em = factory.createEntityManager();
        em.setFlushMode(FlushModeType.AUTO);
        try {
            em.getTransaction().begin();

            Member member = em.find(Member.class, "01012341234");
            List<String> authorities = new ArrayList<>(member.getAuthorities());
            authorities.add("MEMBER");
            member.setAuthorities(authorities);

            log.info("JPQL ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì…ë‹ˆë‹¤.");

            String jpql = "update Member m set m.authorities = 'JQPL_MEMBER' where m.authorities like '%MEMBER%'";
            em.createQuery(jpql).executeUpdate();

            jpql = "select m from Member m where m.authorities like '%JQPL_MEMBER%'";

            TypedQuery<Member> query = em.createQuery(jpql, Member.class);
            List<Member> jpqlMember = query.getResultList();

            log.info("JPQL ì¿¼ë¦¬ ìˆ˜í–‰ í›„ì…ë‹ˆë‹¤.");

            assertTrue(jpqlMember.size() > 0);

            em.getTransaction().commit();
        } catch (Exception ex) {
            em.getTransaction().rollback();
            log.error("exception occurs", ex);
        } finally {
            em.close();
        }
    }
}
```

##### **`FlushModeType.AUTO`** ì˜µì…˜ ì‚¬ìš© í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ê²°ê³¼
- Junit í…ŒìŠ¤íŠ¸ ê²°ê³¼, ìˆ˜í–‰ ë¡œê·¸, ë°ì´í„°ë² ì´ìŠ¤ì— ë§ˆì§€ë§‰ìœ¼ë¡œ ì €ì¥ëœ ë°ì´í„°
- JPQL ë©”ì†Œë“œ ìˆ˜í–‰ ì „ ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ì—ˆìŒì„ ê°ì§€í•˜ì—¬ update ì¿¼ë¦¬ê°€ ìˆ˜í–‰ë˜ëŠ” ê²ƒì„ ë¡œê·¸ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê¶Œí•œì´ 'JQPL_MEMBER'ì¸ ë°ì´í„°ê°€ 1ê±´ ì´ìƒì¸ ê²½ìš° í…ŒìŠ¤íŠ¸ê°€ í†µê³¼ë©ë‹ˆë‹¤.

<p align="left"><img src="/images/jpa-flush-1.JPG" width="45%"></p>

<p align="left"><img src="/images/jpa-flush-2.JPG"></p>

```
Hibernate: select member0_.id as id1_0_0_, member0_.authorities as authorit2_0_0_, member0_.member_email as member_e3_0_0_, member0_.member_name as member_n4_0_0_, member0_.password as password5_0_0_ from tb_member member0_ where member0_.id=?
Hibernate: insert into tb_member (authorities, member_email, member_name, password, id) values (?, ?, ?, ?, ?)
Hibernate: select member0_.id as id1_0_0_, member0_.authorities as authorit2_0_0_, member0_.member_email as member_e3_0_0_, member0_.member_name as member_n4_0_0_, member0_.password as password5_0_0_ from tb_member member0_ where member0_.id=?
2021-08-22 01:53:27.085  INFO 18304 --- [           main] blog.in.action.flush.AutoOptionTest      : JPQL ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì…ë‹ˆë‹¤.
Hibernate: update tb_member set authorities=?, member_email=?, member_name=?, password=? where id=?
Hibernate: update tb_member set authorities='JQPL_MEMBER' where authorities like '%MEMBER%'
Hibernate: select member0_.id as id1_0_, member0_.authorities as authorit2_0_, member0_.member_email as member_e3_0_, member0_.member_name as member_n4_0_, member0_.password as password5_0_ from tb_member member0_ where member0_.authorities like '%JQPL_MEMBER%'
2021-08-22 01:53:27.181  INFO 18304 --- [           main] blog.in.action.flush.AutoOptionTest      : JPQL ì¿¼ë¦¬ ìˆ˜í–‰ í›„ì…ë‹ˆë‹¤.
```

### 3.2. **`FlushModeType.COMMIT`** ì˜µì…˜ ì‚¬ìš© í…ŒìŠ¤íŠ¸

```java
package blog.in.action.flush;

import static org.junit.jupiter.api.Assertions.assertFalse;
import blog.in.action.entity.Member;
import java.util.ArrayList;
import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.FlushModeType;
import javax.persistence.PersistenceUnit;
import javax.persistence.TypedQuery;
import lombok.extern.log4j.Log4j2;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;

@Log4j2
@SpringBootTest
public class CommitOptionTest {

    @PersistenceUnit
    private EntityManagerFactory factory;

    @BeforeEach
    private void beforeEach() {
        EntityManager em = factory.createEntityManager();
        try {
            em.getTransaction().begin();
            Member member = em.find(Member.class, "01012341234");
            if (member == null) {
                member = new Member();
                member.setId("01012341234");
                member.setPassword("1234");
                member.setMemberName("Junhyunny");
                member.setMemberEmail("kang3966@naver.com");
                em.persist(member);
            } else {
                member.setAuthorities(new ArrayList<>());
            }
            em.getTransaction().commit();
        } catch (Exception ex) {
            em.getTransaction().rollback();
            log.error("exception occurs", ex);
        } finally {
            em.close();
        }
    }

    @Test
    public void test() {
        EntityManager em = factory.createEntityManager();
        em.setFlushMode(FlushModeType.COMMIT);
        try {
            em.getTransaction().begin();

            Member member = em.find(Member.class, "01012341234");
            List<String> authorities = new ArrayList<>(member.getAuthorities());
            authorities.add("MEMBER");
            member.setAuthorities(authorities);

            log.info("JPQL ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì…ë‹ˆë‹¤.");

            String jpql = "update Member m set m.authorities = 'JQPL_MEMBER' where m.authorities like '%MEMBER%'";
            em.createQuery(jpql).executeUpdate();

            jpql = "select m from Member m where m.authorities like '%JQPL_MEMBER%'";
            TypedQuery<Member> query = em.createQuery(jpql, Member.class);
            List<Member> jpqlMember = query.getResultList();

            log.info("JPQL ì¿¼ë¦¬ ìˆ˜í–‰ í›„ì…ë‹ˆë‹¤.");

            assertFalse(jpqlMember.size() > 0);

            em.getTransaction().commit();
        } catch (Exception ex) {
            em.getTransaction().rollback();
            log.error("exception occurs", ex);
        } finally {
            em.close();
        }
    }
}
```

##### **`FlushModeType.COMMIT`** ì˜µì…˜ ì‚¬ìš© í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ê²°ê³¼
- Junit í…ŒìŠ¤íŠ¸ ê²°ê³¼, ìˆ˜í–‰ ë¡œê·¸, ë°ì´í„°ë² ì´ìŠ¤ì— ë§ˆì§€ë§‰ìœ¼ë¡œ ì €ì¥ëœ ë°ì´í„°
- **`FlushModeType.AUTO`** í…ŒìŠ¤íŠ¸ì™€ëŠ” ë‹¤ë¥´ê²Œ JPQL ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì— update ì¿¼ë¦¬ê°€ ìˆ˜í–‰ë˜ì§€ ì•ŠìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- íŠ¸ëœì­ì…˜ commit ì‹œì ì— ì—”í‹°í‹° ë³€ê²½ì‚¬í•­ì— ëŒ€í•œ ì—…ë°ì´íŠ¸ê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.
- ê¶Œí•œì´ 'JQPL_MEMBER'ì¸ ë°ì´í„°ê°€ 0ê±´ì¸ ê²½ìš° í…ŒìŠ¤íŠ¸ê°€ í†µê³¼ë©ë‹ˆë‹¤.
- ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœ ë°ì´í„°ê°€ **`FlushModeType.AUTO`** í…ŒìŠ¤íŠ¸ ë•Œì™€ ë‹¤ë¦„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<p align="left"><img src="/images/jpa-flush-3.JPG" width="45%"></p>

<p align="left"><img src="/images/jpa-flush-4.JPG"></p>

```
Hibernate: select member0_.id as id1_0_0_, member0_.authorities as authorit2_0_0_, member0_.member_email as member_e3_0_0_, member0_.member_name as member_n4_0_0_, member0_.password as password5_0_0_ from tb_member member0_ where member0_.id=?
Hibernate: update tb_member set authorities=?, member_email=?, member_name=?, password=? where id=?
Hibernate: select member0_.id as id1_0_0_, member0_.authorities as authorit2_0_0_, member0_.member_email as member_e3_0_0_, member0_.member_name as member_n4_0_0_, member0_.password as password5_0_0_ from tb_member member0_ where member0_.id=?
2021-08-22 01:56:42.849  INFO 18376 --- [           main] blog.in.action.flush.CommitOptionTest    : JPQL ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì…ë‹ˆë‹¤.
Hibernate: update tb_member set authorities='JQPL_MEMBER' where authorities like '%MEMBER%'
Hibernate: select member0_.id as id1_0_, member0_.authorities as authorit2_0_, member0_.member_email as member_e3_0_, member0_.member_name as member_n4_0_, member0_.password as password5_0_ from tb_member member0_ where member0_.authorities like '%JQPL_MEMBER%'
2021-08-22 01:56:42.932  INFO 18376 --- [           main] blog.in.action.flush.CommitOptionTest    : JPQL ì¿¼ë¦¬ ìˆ˜í–‰ í›„ì…ë‹ˆë‹¤.
Hibernate: update tb_member set authorities=?, member_email=?, member_name=?, password=? where id=?
```

## 4. FlushModeType ê°’ì— ë”°ë¥¸ flush ì—¬ë¶€ íŒë‹¨
FlushModeType ì˜µì…˜ ê°’ì— ë”°ë¼ ì–´ë””ì—ì„œ flush ì—¬ë¶€ë¥¼ íŒì •í•˜ëŠ”ì§€ ê¶ê¸ˆí•˜ì—¬ ë””ë²„ê¹…í•´ë³´ì•˜ìŠµë‹ˆë‹¤. 
ì½œ ìŠ¤íƒ(call stack)ì„ í™•ì¸í•˜ë‹ˆ í˜¸ì¶œ ìœ„ì¹˜ëŠ” ì•„ë˜ì™€ ê°™ì•˜ìŠµë‹ˆë‹¤. 

1. org.hibernate.internal.SessionImpl í´ë˜ìŠ¤ - autoFlushIfRequired ë©”ì†Œë“œ
1. org.hibernate.event.internal.DefaultAutoFlushEventListener.onAutoFlush ë©”ì†Œë“œ
1. org.hibernate.event.internal.DefaultAutoFlushEventListener.flushMightBeNeeded ë©”ì†Œë“œ
    - í•´ë‹¹ ìœ„ì¹˜ì—ì„œ FlushMode.Auto ê°’ ì´ìƒì¸ ê²½ìš°ì— flsuh ì—¬ë¶€ê°€ í•„ìš”í•  ê²ƒìœ¼ë¡œ íŒì •í•©ë‹ˆë‹¤.
    - FlushMode.Auto ë³´ë‹¤ í° ê°’ì„ ê°€ì§€ëŠ” ê²½ìš°ëŠ” FlushMode.ALWAYS ë°–ì— ì—†ìŠµë‹ˆë‹¤.

##### Debuging Call Stack

<p align="left"><img src="/images/jpa-flush-5.JPG" width="45%"></p>

##### AutoFlush ìˆ˜í–‰ ì½”ë“œ, DefaultAutoFlushEventListener í´ë˜ìŠ¤
```java
    public void onAutoFlush(AutoFlushEvent event) throws HibernateException {
        final EventSource source = event.getSession();
        final SessionEventListenerManager eventListenerManager = source.getEventListenerManager();
        try {
            eventListenerManager.partialFlushStart();

            if ( flushMightBeNeeded( source ) ) {
                // Need to get the number of collection removals before flushing to executions
                // (because flushing to executions can add collection removal actions to the action queue).
                final ActionQueue actionQueue = source.getActionQueue();
                final int oldSize = actionQueue.numberOfCollectionRemovals();
                flushEverythingToExecutions( event );
                if ( flushIsReallyNeeded( event, source ) ) {
                    LOG.trace( "Need to execute flush" );
                    event.setFlushRequired( true );

                    // note: performExecutions() clears all collectionXxxxtion
                    // collections (the collection actions) in the session
                    performExecutions( source );
                    postFlush( source );

                    postPostFlush( source );

                    final StatisticsImplementor statistics = source.getFactory().getStatistics();
                    if ( statistics.isStatisticsEnabled() ) {
                        statistics.flush();
                    }
                }
                else {
                    LOG.trace( "Don't need to execute flush" );
                    event.setFlushRequired( false );
                    actionQueue.clearFromFlushNeededCheck( oldSize );
                }
            }
        }
        finally {
            eventListenerManager.partialFlushEnd(
                    event.getNumberOfEntitiesProcessed(),
                    event.getNumberOfEntitiesProcessed()
            );
        }
    }

    // ...

    private boolean flushMightBeNeeded(final EventSource source) {
        final PersistenceContext persistenceContext = source.getPersistenceContextInternal();
        return !source.getHibernateFlushMode().lessThan( FlushMode.AUTO )
                && source.getDontFlushFromFind() == 0
                && ( persistenceContext.getNumberOfManagedEntities() > 0 ||
                        persistenceContext.getCollectionEntriesSize() > 0 );
    }
```

## CLOSING
ê°œë°œìê°€ ê¸°ìˆ ì— ëŒ€í•´ ì´í•´ë„ê°€ ë‚®ì€ ê²½ìš° ì˜ë„ì¹˜ ì•Šì€ ë²„ê·¸ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
ë§Œì•½, `'JPQLì€ EntityManagerê°€ flushí•˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ë‹¤.'`ëŠ” ì‚¬ì‹¤ì„ ëª¨ë¥´ê³  ê°œë°œëœ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ì°¾ê¸° ì–´ë ¤ìš´ ë²„ê·¸ë¥¼ ë‚´í¬í•  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤. 
**`'ì˜ë„ì¹˜ ì•ŠëŠ” ë¬¸ì œë¥¼ í”¼í•´ê°€ê³ ì ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ì— ëŒ€í•´ ê¼¼ê¼¼íˆ ê³µë¶€í•˜ì.'`**ë¼ëŠ” ì·¨ì§€ì—ì„œ JPA flushëŠ” ë³„ë„ì˜ ì£¼ì œë¡œ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. 
**`FlushModeType.COMMIT`** ì˜µì…˜ì„ ì‚¬ìš©í•œ í…ŒìŠ¤íŠ¸ì—ì„œ JPQL ì‚¬ìš© ì „ em.flush() ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì–´ë–¤ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.

#### TEST CODE REPOSITORY
- <https://github.com/Junhyunny/blog-in-action/tree/master/2021-02-07-jpa-flush>

#### REFERENCE
- <https://data-make.tistory.com/609>

[java-persistence-api-link]: https://junhyunny.github.io/spring-boot/jpa/java-persistence-api/
[jpa-persistence-context-link]: https://junhyunny.github.io/spring-boot/jpa/junit/jpa-persistence-context/
[persistence-context-advantages-link]: https://junhyunny.github.io/spring-boot/jpa/junit/persistence-context-advantages/

[jpa-clear-link]: https://junhyunny.github.io/spring-boot/jpa/junit/jpa-clear/