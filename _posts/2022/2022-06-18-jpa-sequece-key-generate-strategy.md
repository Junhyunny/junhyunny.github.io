---
title: "JPA Sequence Key ìƒì„± ì „ëµ"
search: false
category:
  - spring-boot
  - jpa
last_modified_at: 2022-06-18T23:55:00
---

<br/>

ğŸ‘‰ í•´ë‹¹ í¬ìŠ¤íŠ¸ë¥¼ ì½ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.
- [EntityManager íŠ¹ì§•ê³¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ì¥ì ][persistence-context-advantages-link]

## 0. ë“¤ì–´ê°€ë©´ì„œ

ë¹„ì¦ˆë‹ˆìŠ¤ì— ë”°ë¼ ê¸°ë³¸ í‚¤(PK, Primary Key) ê°’ì„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì§ì ‘ ì§€ì •í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, í‚¤ ê°’ì´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ë„ë¡ ë§Œë“¤ê³  ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. 
`JPA`ëŠ” ê¸°ë³¸ í‚¤ ìë™ ë°œê¸‰ì„ ìœ„í•œ ê¸°ëŠ¥ê³¼ ëª‡ ê°€ì§€ ì „ëµì„ ì œê³µí•˜ëŠ”ë°, ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„  ì „ëµ ë³„ë¡œ ì–´ë–¤ ì°¨ì´ì ì´ ìˆëŠ”ì§€ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. 

## 1. GenerationType.IDENTITY ì „ëµ

> ê¸°ë³¸ í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„í•©ë‹ˆë‹¤.

### 1.1. í…Œì´ë¸” ìƒì„±

ê¸°ë³¸ í‚¤ ìƒì„±ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„í–ˆê¸° ë•Œë¬¸ì— í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” DDL(database define language) ì¿¼ë¦¬ì— ìë™ í‚¤ ë°œê¸‰ì— ëŒ€í•œ ë‚´ìš©ì´ í•„ìš”í•©ë‹ˆë‹¤. 
ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ì‘ì„±í•©ë‹ˆë‹¤. 

##### H2 ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ìƒì„±
- `generated by default as identity` í‚¤ì›Œë“œ - H2 ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê¸°ë³¸ í‚¤ ìë™ ë°œê¸‰ì„ ìœ„í•´ ì¶”ê°€ë©ë‹ˆë‹¤. 

```sql
create table identity_entity (
    id bigint generated by default as identity,
    primary key (id)
)
```

### 1.2. JPA ì§€ì—° ì“°ê¸° ë¶ˆê°€

`IDENTITY` ì „ëµì€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(persistence context)ì˜ ì¥ì  ì¤‘ í•˜ë‚˜ì¸ `ì§€ì—° ì“°ê¸°`ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. 
`IDENTITY` ì „ëµì€ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ í‚¤ ê°’ì€ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°ì´í„°ë¥¼ ì €ì¥í•œ ì´í›„ì— í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ì—”í‹°í‹°(entity)ë¥¼ 1ì°¨ ìºì‹±ì— ì €ì¥í•˜ê¸° ìœ„í•´ì„œ ê¸°ë³¸ í‚¤ í•„ë“œ(`@Id` ì• ë„ˆí…Œì´ì…˜ì´ ë¶™ì€ í•„ë“œ)ì— ê°’ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— `save` ë©”ì„œë“œ ìˆ˜í–‰ ì‹œ `insert` ì¿¼ë¦¬ë¥¼ ë§¤ë²ˆ `flush`í•©ë‹ˆë‹¤. 

### 1.3. ì˜ˆì‹œ ì½”ë“œ

#### 1.3.1. IdentityEntity í´ë˜ìŠ¤

- `@GeneratedValue` ì• ë„ˆí…Œì´ì…˜ì˜ ìƒì„± ì „ëµì„ `GenerationType.IDENTITY`ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.

```java
package blog.in.action.identity;

import lombok.Getter;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Getter
@Entity
public class IdentityEntity {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
}
```

#### 1.3.2. IdentityTests í´ë˜ìŠ¤

- ë°˜ë³µë¬¸ì„ í†µí•´ ë°ì´í„°ë¥¼ ì¶”ê°€ë¥¼ 3íšŒ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ ë°œê¸‰ëœ ê¸°ë³¸ í‚¤ ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.

```java
package blog.in.action.identity;

import lombok.extern.log4j.Log4j2;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;

import java.util.List;

@Log4j2
@DataJpaTest
public class IdentityTests {

    @Autowired
    IdentityRepository repository;

    @Test
    void test() {

        log.info("ì¶”ê°€");
        for (int index = 0; index < 3; index++) {
            log.info("before save");
            repository.save(new IdentityEntity());
            log.info("after save");
        }

        log.info("ì¡°íšŒ");
        List<IdentityEntity> entities = repository.findAll();
        for (IdentityEntity entity : entities) {
            log.info(entity.getId());
        }
    }
}
```

### 1.4. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¡œê·¸ í™•ì¸

í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ë¡œê·¸ë¥¼ í†µí•´ ë™ì‘ ê³¼ì •ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
- `JpaRepository`ì˜ `save` ë©”ì„œë“œ ìˆ˜í–‰ ì‹œ ë§¤ë²ˆ `insert` ì¿¼ë¦¬ê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.
- `insert` ì¿¼ë¦¬ ìˆ˜í–‰ ì‹œ `id`ì— `null` ê°’ì„ ì‚½ì…í•˜ì§€ë§Œ, ì¡°íšŒ ì‹œ ê°’ì´ ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
2022-06-19 05:36:29.148  INFO 32296 --- [           main] o.s.t.c.transaction.TransactionContext   : Began transaction (1) for test context [DefaultTestContext@2a640157 testClass = IdentityTests, testInstance = blog.in.action.identity.IdentityTests@5f9678e1, testMethod = test@IdentityTests, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@52851b44 testClass = IdentityTests, locations = '{}', classes = '{class blog.in.action.ActionInBlogApplication}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTestContextBootstrapper=true}', contextCustomizers = set[[ImportsContextCustomizer@584f54e6 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration, org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration, org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration, org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration, org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration, org.springframework.boot.test.autoconfigure.jdbc.TestDatabaseAutoConfiguration, org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManagerAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@74a6f9c1, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@63611043, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@51549490, org.springframework.boot.test.autoconfigure.actuate.metrics.MetricsExportContextCustomizerFactory$DisableMetricExportContextCustomizer@7daa0fbd, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@351584c0, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@92765d80, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2796aeae, org.springframework.boot.test.context.SpringBootTestArgs@1, org.springframework.boot.test.context.SpringBootTestWebEnvironment@0], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.event.ApplicationEventsTestExecutionListener.recordApplicationEvents' -> false]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@76dc36e5]; rollback [true]
2022-06-19 05:36:29.236  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : ì¶”ê°€
2022-06-19 05:36:29.237  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : before save
Hibernate: 
    insert 
    into
        identity_entity
        (id) 
    values
        (null)
2022-06-19 05:36:29.266  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : after save
2022-06-19 05:36:29.266  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : before save
Hibernate: 
    insert 
    into
        identity_entity
        (id) 
    values
        (null)
2022-06-19 05:36:29.266  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : after save
2022-06-19 05:36:29.267  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : before save
Hibernate: 
    insert 
    into
        identity_entity
        (id) 
    values
        (null)
2022-06-19 05:36:29.267  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : after save
2022-06-19 05:36:29.267  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : ì¡°íšŒ
Hibernate: 
    select
        identityen0_.id as id1_0_ 
    from
        identity_entity identityen0_
2022-06-19 05:36:29.396  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : 1
2022-06-19 05:36:29.396  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : 2
2022-06-19 05:36:29.396  INFO 32296 --- [           main] blog.in.action.identity.IdentityTests    : 3
2022-06-19 05:36:29.402  INFO 32296 --- [           main] o.s.t.c.transaction.TransactionContext   : Rolled back transaction for test: [DefaultTestContext@2a640157 testClass = IdentityTests, testInstance = blog.in.action.identity.IdentityTests@5f9678e1, testMethod = test@IdentityTests, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@52851b44 testClass = IdentityTests, locations = '{}', classes = '{class blog.in.action.ActionInBlogApplication}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTestContextBootstrapper=true}', contextCustomizers = set[[ImportsContextCustomizer@584f54e6 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration, org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration, org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration, org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration, org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration, org.springframework.boot.test.autoconfigure.jdbc.TestDatabaseAutoConfiguration, org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManagerAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@74a6f9c1, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@63611043, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@51549490, org.springframework.boot.test.autoconfigure.actuate.metrics.MetricsExportContextCustomizerFactory$DisableMetricExportContextCustomizer@7daa0fbd, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@351584c0, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@92765d80, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2796aeae, org.springframework.boot.test.context.SpringBootTestArgs@1, org.springframework.boot.test.context.SpringBootTestWebEnvironment@0], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.event.ApplicationEventsTestExecutionListener.recordApplicationEvents' -> false]]
```

## 2. GenerationType.SEQUENCE ì „ëµ

> ë°ì´í„°ë² ì´ìŠ¤ì˜Â ì‹œí€€ìŠ¤ ê°ì²´(sequence object)ë¥¼Â ì´ìš©í•˜ì—¬Â ìœ ì¼í•œÂ ê°’ì„Â ìˆœì„œëŒ€ë¡œÂ ìƒì„±í•©ë‹ˆë‹¤.

### 2.1. ì‹œí€€ìŠ¤ ê°ì²´ì™€ í…Œì´ë¸” ìƒì„±

`GenerationType.SEQUENCE` ì „ëµì€ ë°ì´í„°ë² ì´ìŠ¤ì— ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ ì‹œí€€ìŠ¤ ê°ì²´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. 
ì‹œí€€ìŠ¤ ê°ì²´ë¥¼ ë§Œë“œëŠ” ë°©ë²•ê³¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ë§ˆë‹¤ ë‹¤ë¦…ë‹ˆë‹¤. 

##### H2 ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ ê°ì²´ ìƒì„±

- `my_seq`ë¼ëŠ” ì´ë¦„ì˜ ì‹œí€€ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- ìµœì´ˆ ê°’ì€ 1ì—ì„œ ì‹œì‘í•˜ê³ , ì‚¬ìš©í•  ë•Œë§ˆë‹¤ 1ì”© ì¦ê°€í•©ë‹ˆë‹¤.

```sql
create sequence my_seq start with 1 increment by 1
```

### 2.2. ì˜ˆì‹œ ì½”ë“œ

#### 2.2.1. SequenceEntity í´ë˜ìŠ¤

- `@GeneratedValue` ì• ë„ˆí…Œì´ì…˜
    - ìƒì„± ì „ëµì„ `GenerationType.SEQUENCE`ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.
    - ê¸°ë³¸ í‚¤ ìƒì„±ìë¥¼ `SEQ_GENERATOR`ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.
- `@SequenceGenerator` ì• ë„ˆí…Œì´ì…˜
    - name - ê¸°ë³¸ í‚¤ ìƒì„±ì ì´ë¦„ì€ `SEQ_GENERATOR`ì…ë‹ˆë‹¤.
    - sequenceName - `SEQ_GENERATOR`ê°€ ì‚¬ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ì˜ ì‹œí€€ìŠ¤ ê°ì²´ëŠ” `MY_SEQ`ì…ë‹ˆë‹¤. 
    - allocationSize - ì‹œí€€ìŠ¤ ê°ì²´ í˜¸ì¶œ ì‹œ ì¦ê°€í•˜ëŠ” ê°’ì€ 1ë¡œ ì§€ì •í•©ë‹ˆë‹¤.

```java
package blog.in.action.sequence;

import lombok.Getter;

import javax.persistence.*;

@Getter
@SequenceGenerator(
        name = "SEQ_GENERATOR",
        sequenceName = "MY_SEQ",
        allocationSize = 1
)
@Entity
public class SequenceEntity {

    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "SEQ_GENERATOR")
    private Long id;
}
```

#### 2.2.2. SequenceTests í´ë˜ìŠ¤

- ë°˜ë³µë¬¸ì„ í†µí•´ ë°ì´í„°ë¥¼ ì¶”ê°€ë¥¼ 3íšŒ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ ë°œê¸‰ëœ ê¸°ë³¸ í‚¤ ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.

```java
package blog.in.action.sequence;

import lombok.extern.log4j.Log4j2;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;

import java.util.List;

@Log4j2
@DataJpaTest
public class SequenceTests {

    @Autowired
    SequenceRepository repository;

    @Test
    void test() {

        log.info("ì¶”ê°€");
        for (int index = 0; index < 3; index++) {
            log.info("before save");
            repository.save(new SequenceEntity());
            log.info("after save");
        }

        log.info("ì¡°íšŒ");
        List<SequenceEntity> entities = repository.findAll();
        for (SequenceEntity entity : entities) {
            log.info(entity.getId());
        }
    }
}
```

### 2.3. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¡œê·¸ í™•ì¸

í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ë¡œê·¸ë¥¼ í†µí•´ ë™ì‘ ê³¼ì •ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
- `JpaRepository`ì˜ `save` ë©”ì„œë“œ ìˆ˜í–‰ ì‹œ ë§¤ë²ˆ ì‹œí€€ìŠ¤ ê°’ì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.
    - `call next value for my_seq` - H2 ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‹œí€€ìŠ¤ í‚¤ë¥¼ ë°œê¸‰ë°›ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.
- ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” `select` ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì— JPA `ì§€ì—° ì“°ê¸°`ë¥¼ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— `insert` ì¿¼ë¦¬ê°€ 3íšŒ ìˆ˜í–‰ë©ë‹ˆë‹¤.
    - `insert` ì¿¼ë¦¬ ìˆ˜í–‰ ì‹œ `id`ì— ë°œê¸‰ë°›ì€ ì‹œí€€ìŠ¤ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
2022-06-19 06:46:54.910  INFO 54837 --- [           main] o.s.t.c.transaction.TransactionContext   : Began transaction (1) for test context [DefaultTestContext@2dca0d64 testClass = SequenceTests, testInstance = blog.in.action.sequence.SequenceTests@112f364d, testMethod = test@SequenceTests, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@f80945f testClass = SequenceTests, locations = '{}', classes = '{class blog.in.action.ActionInBlogApplication}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTestContextBootstrapper=true}', contextCustomizers = set[[ImportsContextCustomizer@ff684e1 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration, org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration, org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration, org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration, org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration, org.springframework.boot.test.autoconfigure.jdbc.TestDatabaseAutoConfiguration, org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManagerAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@74a6f9c1, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@63611043, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@51549490, org.springframework.boot.test.autoconfigure.actuate.metrics.MetricsExportContextCustomizerFactory$DisableMetricExportContextCustomizer@7daa0fbd, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@351584c0, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@92765d80, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2796aeae, org.springframework.boot.test.context.SpringBootTestArgs@1, org.springframework.boot.test.context.SpringBootTestWebEnvironment@0], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.event.ApplicationEventsTestExecutionListener.recordApplicationEvents' -> false]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@3ee258]; rollback [true]
2022-06-19 06:46:54.990  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : ì¶”ê°€
2022-06-19 06:46:54.990  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : before save
Hibernate: 
    call next value for my_seq
2022-06-19 06:46:55.018  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : after save
2022-06-19 06:46:55.019  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : before save
Hibernate: 
    call next value for my_seq
2022-06-19 06:46:55.019  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : after save
2022-06-19 06:46:55.019  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : before save
Hibernate: 
    call next value for my_seq
2022-06-19 06:46:55.020  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : after save
2022-06-19 06:46:55.020  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : ì¡°íšŒ
Hibernate: 
    insert 
    into
        sequence_entity
        (id) 
    values
        (?)
Hibernate: 
    insert 
    into
        sequence_entity
        (id) 
    values
        (?)
Hibernate: 
    insert 
    into
        sequence_entity
        (id) 
    values
        (?)
Hibernate: 
    select
        sequenceen0_.id as id1_1_ 
    from
        sequence_entity sequenceen0_
2022-06-19 06:46:55.135  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : 1
2022-06-19 06:46:55.136  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : 2
2022-06-19 06:46:55.136  INFO 54837 --- [           main] blog.in.action.sequence.SequenceTests    : 3
2022-06-19 06:46:55.143  INFO 54837 --- [           main] o.s.t.c.transaction.TransactionContext   : Rolled back transaction for test: [DefaultTestContext@2dca0d64 testClass = SequenceTests, testInstance = blog.in.action.sequence.SequenceTests@112f364d, testMethod = test@SequenceTests, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@f80945f testClass = SequenceTests, locations = '{}', classes = '{class blog.in.action.ActionInBlogApplication}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTestContextBootstrapper=true}', contextCustomizers = set[[ImportsContextCustomizer@ff684e1 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration, org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration, org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration, org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration, org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration, org.springframework.boot.test.autoconfigure.jdbc.TestDatabaseAutoConfiguration, org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManagerAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@74a6f9c1, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@63611043, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@51549490, org.springframework.boot.test.autoconfigure.actuate.metrics.MetricsExportContextCustomizerFactory$DisableMetricExportContextCustomizer@7daa0fbd, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@351584c0, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@92765d80, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2796aeae, org.springframework.boot.test.context.SpringBootTestArgs@1, org.springframework.boot.test.context.SpringBootTestWebEnvironment@0], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.event.ApplicationEventsTestExecutionListener.recordApplicationEvents' -> false]]
```

## 3. GenerationType.TABLE ì „ëµ

> í‚¤Â ìƒì„±Â ì „ìš©Â í…Œì´ë¸”ì„Â í•˜ë‚˜Â ë§Œë“¤ê³ Â ì—¬ê¸°ì—Â ì´ë¦„ê³¼Â ê°’ìœ¼ë¡œÂ ì‚¬ìš©í• Â ì»¬ëŸ¼ì„Â ë§Œë“¤ì–´Â ë°ì´í„°ë² ì´ìŠ¤Â ì‹œí€€ìŠ¤ë¥¼Â í‰ë‚´ë‚´ëŠ”Â ì „ëµì…ë‹ˆë‹¤.

### 3.1. í…Œì´ë¸” ìƒì„±

ì‹œí€€ìŠ¤ ê°’ì„ ë°œê¸‰í•˜ê¸° ìœ„í•œ í…Œì´ë¸”ì„ ë³„ë„ë¡œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ì— ì˜ì¡´ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. 
ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ì—ì„œ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì‹œí€€ìŠ¤ í…Œì´ë¸” ìƒì„± ë° ì´ˆê¸°í™” ì‘ì—…ì´ ë°˜ë“œì‹œ ì„ í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. 

##### H2 ë°ì´í„°ë² ì´ìŠ¤ ì‹œí€€ìŠ¤ í…Œì´ë¸” ìƒì„± ë° ì´ˆê¸°í™”

- ì‹œí€€ìŠ¤ ì´ë¦„(sequence_name)ê³¼ ì‹œí€€ìŠ¤ ê°’(next_val)ì„ ê°€ì§€ëŠ” í…Œì´ë¸”ì„ ë§Œë“­ë‹ˆë‹¤.
    - ì‹œí€€ìŠ¤ ì´ë¦„ì€ ë³„ë„ë¡œ ì§€ì •í•˜ì§€ ì•ŠëŠ” ê²½ìš° ë””í´íŠ¸ ê°’ìœ¼ë¡œ ì—”í‹°í‹° ì´ë¦„ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- í…Œì´ë¸”ì„ ë§Œë“  í›„ì— ì‚¬ìš©í•  ì‹œí€€ìŠ¤ ì´ë¦„ê³¼ ì´ˆê¸° ê°’ì„ `insert`í•©ë‹ˆë‹¤.

```sql
create table seq_table (
   sequence_name varchar(255) not null,
    next_val bigint,
    primary key (sequence_name)
)

insert into seq_table(sequence_name, next_val) values ('table_entity', 0)
```

### 3.2. ì˜ˆì‹œ ì½”ë“œ

#### 3.2.1. TableEntity í´ë˜ìŠ¤

- `@GeneratedValue` ì• ë„ˆí…Œì´ì…˜
    - ìƒì„± ì „ëµì„ `GenerationType.SEQUENCE`ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.
    - ê¸°ë³¸ í‚¤ ìƒì„±ìë¥¼ `TABLE_SEQ_GENERATOR`ìœ¼ë¡œ ì§€ì •í•©ë‹ˆë‹¤.
- `@TableGenerator` ì• ë„ˆí…Œì´ì…˜
    - name - ê¸°ë³¸ í‚¤ ìƒì„±ì ì´ë¦„ì€ `TABLE_SEQ_GENERATOR`ì…ë‹ˆë‹¤.
    - table - `TABLE_SEQ_GENERATOR`ê°€ ì‚¬ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸”ì€ `SEQ_TABLE`ì…ë‹ˆë‹¤. 
    - allocationSize - ì‹œí€€ìŠ¤ í…Œì´ë¸” ì‚¬ìš© ì‹œ ì¦ê°€í•˜ëŠ” ê°’ì€ 1ë¡œ ì§€ì •í•©ë‹ˆë‹¤.

```java
package blog.in.action.table;

import lombok.Getter;

import javax.persistence.*;

@Getter
@TableGenerator(
        name = "TABLE_SEQ_GENERATOR",
        table = "SEQ_TABLE",
        allocationSize = 1
)
@Entity
public class TableEntity {

    @Id
    @GeneratedValue(strategy = GenerationType.TABLE, generator = "TABLE_SEQ_GENERATOR")
    private Long id;
}
```

#### 3.2.2. TableTests í´ë˜ìŠ¤

- ë°˜ë³µë¬¸ì„ í†µí•´ ë°ì´í„°ë¥¼ ì¶”ê°€ë¥¼ 3íšŒ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ ë°œê¸‰ëœ ê¸°ë³¸ í‚¤ ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.

```java
package blog.in.action.table;

import lombok.extern.log4j.Log4j2;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;

import java.util.List;

@Log4j2
@DataJpaTest
public class TableTests {

    @Autowired
    TableRepository repository;

    @Test
    void test() {

        log.info("ì¶”ê°€");
        for (int index = 0; index < 3; index++) {
            log.info("before save");
            repository.save(new TableEntity());
            log.info("after save");
        }

        log.info("ì¡°íšŒ");
        List<TableEntity> entities = repository.findAll();
        for (TableEntity entity : entities) {
            log.info(entity.getId());
        }
    }
}
```

### 3.3. í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¡œê·¸ í™•ì¸

í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ë¡œê·¸ë¥¼ í†µí•´ ë™ì‘ ê³¼ì •ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
- `JpaRepository`ì˜ `save` ë©”ì„œë“œ ìˆ˜í–‰ ì‹œ ë§¤ë²ˆ ì‹œí€€ìŠ¤ ê°’ì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤.
    - ì‹œí€€ìŠ¤ ê°’ ë°œê¸‰ì„ ìœ„í•´ `select`, `update` 2íšŒ ì¿¼ë¦¬ê°€ ìˆ˜í–‰ë©ë‹ˆë‹¤.
    - `select` ì¿¼ë¦¬ - `seq_table` í…Œì´ë¸”ë¡œë¶€í„° ì—”í‹°í‹°ì— í•´ë‹¹ë˜ëŠ” ì‹œí€€ìŠ¤ ê°’ì„ ì¡°íšŒí•©ë‹ˆë‹¤. `for update` í‚¤ì›Œë“œë¡œ í•´ë‹¹ ì‹œí€€ìŠ¤ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ë©´ì„œ ë°ì´í„° ë½(lock)ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    - `update` ì¿¼ë¦¬ - `seq_table` í…Œì´ë¸”ì— í•´ë‹¹ ì—”í‹°í‹°ê°€ ë‹¤ìŒìœ¼ë¡œ ì‚¬ìš©í•  ì‹œí€€ìŠ¤ ê°’ì„ `update`í•©ë‹ˆë‹¤.
- ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” `select` ì¿¼ë¦¬ ìˆ˜í–‰ ì „ì— JPA `ì§€ì—° ì“°ê¸°`ë¥¼ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— `insert` ì¿¼ë¦¬ê°€ 3íšŒ ìˆ˜í–‰ë©ë‹ˆë‹¤.
    - `insert` ì¿¼ë¦¬ ìˆ˜í–‰ ì‹œ `id`ì— ë°œê¸‰ë°›ì€ ì‹œí€€ìŠ¤ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
2022-06-19 07:17:43.340  INFO 64356 --- [           main] o.s.t.c.transaction.TransactionContext   : Began transaction (1) for test context [DefaultTestContext@74bada02 testClass = TableTests, testInstance = blog.in.action.table.TableTests@31d0e481, testMethod = test@TableTests, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@525575 testClass = TableTests, locations = '{}', classes = '{class blog.in.action.ActionInBlogApplication}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTestContextBootstrapper=true}', contextCustomizers = set[[ImportsContextCustomizer@46dffdc3 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration, org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration, org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration, org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration, org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration, org.springframework.boot.test.autoconfigure.jdbc.TestDatabaseAutoConfiguration, org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManagerAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@135606db, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@4f74980d, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@616ac46a, org.springframework.boot.test.autoconfigure.actuate.metrics.MetricsExportContextCustomizerFactory$DisableMetricExportContextCustomizer@6337c201, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@351584c0, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@92765d80, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2ce6c6ec, org.springframework.boot.test.context.SpringBootTestArgs@1, org.springframework.boot.test.context.SpringBootTestWebEnvironment@0], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.event.ApplicationEventsTestExecutionListener.recordApplicationEvents' -> false]]; transaction manager [org.springframework.orm.jpa.JpaTransactionManager@29699283]; rollback [true]
2022-06-19 07:17:43.427  INFO 64356 --- [           main] blog.in.action.table.TableTests          : ì¶”ê°€
2022-06-19 07:17:43.428  INFO 64356 --- [           main] blog.in.action.table.TableTests          : before save
Hibernate: 
    select
        tbl.next_val 
    from
        seq_table tbl 
    where
        tbl.sequence_name=? for update
            
Hibernate: 
    update
        seq_table 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?
2022-06-19 07:17:43.461  INFO 64356 --- [           main] blog.in.action.table.TableTests          : after save
2022-06-19 07:17:43.461  INFO 64356 --- [           main] blog.in.action.table.TableTests          : before save
Hibernate: 
    select
        tbl.next_val 
    from
        seq_table tbl 
    where
        tbl.sequence_name=? for update
            
Hibernate: 
    update
        seq_table 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?
2022-06-19 07:17:43.463  INFO 64356 --- [           main] blog.in.action.table.TableTests          : after save
2022-06-19 07:17:43.463  INFO 64356 --- [           main] blog.in.action.table.TableTests          : before save
Hibernate: 
    select
        tbl.next_val 
    from
        seq_table tbl 
    where
        tbl.sequence_name=? for update
            
Hibernate: 
    update
        seq_table 
    set
        next_val=?  
    where
        next_val=? 
        and sequence_name=?
2022-06-19 07:17:43.465  INFO 64356 --- [           main] blog.in.action.table.TableTests          : after save
2022-06-19 07:17:43.465  INFO 64356 --- [           main] blog.in.action.table.TableTests          : ì¡°íšŒ
Hibernate: 
    insert 
    into
        table_entity
        (id) 
    values
        (?)
Hibernate: 
    insert 
    into
        table_entity
        (id) 
    values
        (?)
Hibernate: 
    insert 
    into
        table_entity
        (id) 
    values
        (?)
Hibernate: 
    select
        tableentit0_.id as id1_2_ 
    from
        table_entity tableentit0_
2022-06-19 07:17:43.589  INFO 64356 --- [           main] blog.in.action.table.TableTests          : 1
2022-06-19 07:17:43.589  INFO 64356 --- [           main] blog.in.action.table.TableTests          : 2
2022-06-19 07:17:43.589  INFO 64356 --- [           main] blog.in.action.table.TableTests          : 3
2022-06-19 07:17:43.597  INFO 64356 --- [           main] o.s.t.c.transaction.TransactionContext   : Rolled back transaction for test: [DefaultTestContext@74bada02 testClass = TableTests, testInstance = blog.in.action.table.TableTests@31d0e481, testMethod = test@TableTests, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@525575 testClass = TableTests, locations = '{}', classes = '{class blog.in.action.ActionInBlogApplication}', contextInitializerClasses = '[]', activeProfiles = '{}', propertySourceLocations = '{}', propertySourceProperties = '{org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTestContextBootstrapper=true}', contextCustomizers = set[[ImportsContextCustomizer@46dffdc3 key = [org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration, org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration, org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration, org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration, org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration, org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration, org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration, org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration, org.springframework.boot.test.autoconfigure.jdbc.TestDatabaseAutoConfiguration, org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManagerAutoConfiguration]], org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@135606db, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@4f74980d, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.autoconfigure.OverrideAutoConfigurationContextCustomizerFactory$DisableAutoConfigurationContextCustomizer@616ac46a, org.springframework.boot.test.autoconfigure.actuate.metrics.MetricsExportContextCustomizerFactory$DisableMetricExportContextCustomizer@6337c201, org.springframework.boot.test.autoconfigure.filter.TypeExcludeFiltersContextCustomizer@351584c0, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@92765d80, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizerFactory$Customizer@2ce6c6ec, org.springframework.boot.test.context.SpringBootTestArgs@1, org.springframework.boot.test.context.SpringBootTestWebEnvironment@0], contextLoader = 'org.springframework.boot.test.context.SpringBootContextLoader', parent = [null]], attributes = map['org.springframework.test.context.event.ApplicationEventsTestExecutionListener.recordApplicationEvents' -> false]]
```

## 4. GenerationType.AUTO ì „ëµ

> ë°ì´í„°ë² ì´ìŠ¤ì— ë”°ë¼ INDENTITY, SEQUENCE, TABLE ì „ëµ ì¤‘ í•˜ë‚˜ë¥¼ ìë™ìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤.

í‚¤ ìƒì„± ì „ëµì´ ì •í•´ì§€ì§€ ì•Šì€ ê°œë°œ ì´ˆê¸° ë‹¨ê³„ë‚˜ í”„ë¡œí† íƒ€ì… ê°œë°œ ì‹œ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ë§ˆë‹¤ ë‹¤ë¥¸ ì „ëµì„ ì„ íƒí•˜ê¸° ë•Œë¬¸ì— `SEQUENCE`, `TABLE` ì „ëµì´ ì„ íƒëœë‹¤ë©´ ë¯¸ë¦¬ ì„ í–‰ ì‘ì—…ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

##### H2 ë°ì´í„°ë² ì´ìŠ¤ AUTO ì „ëµ ì‚¬ìš© ì‹œ ì‹œí€€ìŠ¤ ê°ì²´ ìƒì„±

- H2 ë°ì´í„°ë² ì´ìŠ¤ëŠ” `SEQUENCE` ì „ëµì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```sql
create sequence hibernate_sequence start with 1 increment by 1
```

#### TEST CODE REPOSITORY
- <https://github.com/Junhyunny/blog-in-action/tree/master/2022-06-18-jpa-sequence-key-generate-strategy>

#### REFERENCE
- <https://xzio.tistory.com/1446>
- <https://newwisdom.tistory.com/90>

[persistence-context-advantages-link]: https://junhyunny.github.io/spring-boot/jpa/junit/persistence-context-advantages/