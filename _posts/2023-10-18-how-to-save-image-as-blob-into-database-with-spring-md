---
title: "How to save image as blob into PostgreSQL with Spring"
search: false
category:
  - kotlin
  - spring-boot
  - postgresql
last_modified_at: 2023-10-18T23:55:00
---

<br/>

#### RECOMMEND POSTS BEFORE THIS

* [How to test file upload in Spring][multipart-file-upload-in-spring-link]

## 1. Development Environment

일반적으로 이미지는 파일 시스템(file system)이나 AWS S3 같은 외부 저장소를 사용해 저장합니다. 

* 비용 측면에서 데이터베이스보다 파일 시스템이나 AWS S3가 저렴합니다.
* 관계형 데이터베이스는 일반적으로 정형화 된 텍스트 기반 데이터 처리에 최적화되어 있습니다. 
* AWS S3 같은 외부 저장소를 사용하면 이미지 요청에 대한 서버의 부하를 감소시킬 수 있습니다.

하지만 현재 개발 중인 웹 어플리케이션은 클라우드 환경이라 서버의 파일 시스템을 사용할 수 없고, 부족한 개발 시간을 벌고 외부 의존성을 줄이기 위해 데이터베이스에 이미지를 저장하기로 결정했습니다. 
다음과 같은 개발 환경에서 작업을 수행하였습니다. 

* 코틀린(kotiln)
* 스프링 부트(spring boot) 3.0.7
* JPA
* PostgresSQL

이번 포스트는 파일을 업로드 후 파일을 데이터베이스에 저장하는 과정에서 겪은 문제와 테스트 방법에 대해 정리하였습니다. 
스프링 프레임워크에서 파일을 업로드 하는 방법이나 단위 테스트에 대한 내용은 [How to test file upload in Spring][multipart-file-upload-in-spring-link] 포스트를 참고하시길 바랍니다.

## 2. Practice

### 2.1. application.yml

### 2.2. 

## CLOSING

#### TEST CODE REPOSITORY

#### RECOMMEND NEXT POSTS

#### REFERENCE

* <https://stackoverflow.com/questions/35505424/how-to-read-bytea-image-data-from-postgresql-with-jpa>
* <https://stackoverflow.com/questions/75354646/using-type-for-binary-data-in-hibernate-6>

[multipart-file-upload-in-spring-link]: https://junhyunny.github.io/java/spring-boot/how-to-test-multipart-file-upload-in-spring/