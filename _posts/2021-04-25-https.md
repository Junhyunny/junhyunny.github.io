---
title: "HTTPS(HyperText Transfer Protocol over Secure Socket Layer)"
search: false
category:
  - information
last_modified_at: 2021-04-26T00:00:00
---

<br>

[지난 포스트][http-blogLink]에서 HTTP 프로토콜에 관해 정리해보았습니다. 
이번엔 보안과 관련되어 조금 더 보완된 HTTPS(HyperText Transfer Protocol over Secure Socket Layer)에 대해 알아보겠습니다. 

## HTTPS(HyperText Transfer Protocol over Secure Socket Layer) 란?

HTTP 통신의 보안 측면에서 문제가 있어 이를 개선한 통신 프로토콜입니다. 

##### HTTP 통신의 보안 문제
- 암호화하지 않은 통신이므로 도청이 가능합니다.
- 통신 상대를 확인하지 않으므로 위장할 수 있습니다.
- 완전성을 증명할 수 없기 때문에 변조할 수 있습니다.

> HyperText Transfer Protocol over Secure Socket Layer<br>
> SSL(Secure Socket Layer)을 통한 하이퍼 텍스트 전송 프로토콜

HTTPS 이름의 **`over Secure Socket Layer`** 라는 문장에서 벌써 느낌이 옵니다. 
보안과 관련된 Layer를 한 단계 더 거쳐서 통신을 하는 방법입니다. 
참고로 SSL(Secure Socket Layer)라는 단어는 TLS(Transport Layer Security)라는 용어로 바뀌었지만 아직 SSL이라는 명칭을 많이 사용하고 있습니다.

##### HTTPS 통신 Layer
<p align="center"><img src="/images/https-1.JPG" width="80%"></p>
<center>이미지 출처, https://heidyhe.github.io/https/</center><br>

위의 이미지에서 보이듯 HTTP 통신과 달리 HTTPS 통신은 application layer와 transport layer 사이에 security layer가 하나 더 존재합니다. 
Security 계층에서는 Application 계층에서 전달받은 메세지를 암호화하여 Transport 계층으로 내려주거나, 
Transport 계층에서 올라온 데이터를 Application 계층으로 복호화하여 넘겨줍니다. 
다른 이미지를 통해 조금 더 쉽게 이해해보겠습니다. 

##### HTTPS 통신 시 메세지 전달 과정
<p align="center"><img src="/images/https-2.JPG" width="80%"></p>

## 암호화 방식
일단 암호화 방식에 대해 알아야 합니다. 
암호화 방식은 크게 대칭키 방식, 비대칭키 방식이 존재하고 HTTPS 통신은 두 개의 암호화 방식을 모두 사용합니다. 

### 대칭키 방식(Symmetric Key)
- 하나의 키로 암호화 복호화를 모두 하는 암호화 방식입니다. 
- 하나의 키로 암호화, 복호화가 가능하므로 해당 키가 노출되면 보안에 문제가 발생합니다.
- 비대칭키 방식에 비해 속도가 빠릅니다.

<p align="center"><img src="/images/https-3.JPG" width="80%"></p>
<center>이미지 출처, https://mysterico.tistory.com/30</center><br>

### 비대칭키 방식(Asymmetric Key)
- 키가 두 개 존재합니다. A Key로 암호화를 하면 B Key로 복호화할 수 있습니다.
- 반대로 B Key로 암호화하면 A Key로 복호화할 수 있습니다.
- 두 개의 키를 모두 노출되지 않는 한 보안상 문제가 없습니다.
- 둘 중 하나는 비공개 키(private key)로 외부에 공개하지 않고, 하나는 공개 키(public key)로 타인에게 제공합니다.
- 속도가 느리다는 단점을 가지고 있습니다.

<p align="center"><img src="/images/https-4.JPG" width="80%"></p>
<center>이미지 출처, https://mysterico.tistory.com/30/</center><br>

## CA(Certificate authority) 기업과 SSL 인증서
Security 계층에서는 암호화와 복호화가 이루어진다고 하는데 어떤 방법을 통해 이루어질까요? 
우선 CA(Certificate authority) 기업과 SSL 인증서가 무엇인지 알아야 합니다.

### CA(Certificate authority) 기업
SSL 인증서를 발급해주는 기업들을 CA(Certificate authority) 혹은 Root Certificate 라고 부릅니다. 
CA는 아무 기업이나 할 수 있는 것이 아니고 신뢰성이 업격하게 공인된 기업들만 참여할 수 있습니다.([위키피디아 참조][ca-wiki-link])

##### CA 시장 점유율

| Rank | Issuer | Usage | Market share |
|:---:|:---:|:---:|:---:|
| 1 | IdenTrust | 38.0% | 51.2% |
| 2 | DigiCert | 14.6% | 19.7% |
| 3 | Sectigo | 13.1% | 17.7% |
| 4 | GoDaddy | 5.1% | 6.9% |
| 5 | GlobalSign | 2.2% | 3.0% |

### SSL 인증서

> SSL 인증서는 클라이언트와 서버간의 통신을 제3자가 보증해주는 전자화 된 문서다. 

서비스 기업들은 자신의 공개 키를 클라이언트에게 안전하게 제공하기 위해 SSL 인증서를 이용합니다. 
SSL 인증서는 CA(Certificate authority) 기업을 통해 만들 수 있습니다. 
서비스 기업은 자신의 공개 키를 CA 기업에게 제공하고 SSL 인증서 생성을 요청합니다. 
CA 기업은 자신의 비공개 키로 몇 가지 정보들을 암호화 한 SSL 인증서를 만들어 서비스 기업에게 전달합니다.

SSL 인증서에는 다음과 같은 정보를 가지고 있습니다. 
- 해당 인증서를 발급한 CA(Certificate authority)
- 서비스의 도메인
- 서버에서 제공하는 공개 키(public key)와 암호화 방법

클라이언트가 브라우저를 통해 서버에 접속하면 서버는 미리 발급해놓은 암호화 된 SSL 인증서 정보를 클라이언트에게 전달합니다. 
클라이언트는 전달받은 SSL 인증서를 CA 기업의 공개 키로 복호화합니다. 
세계적으로 신뢰할 수 있는 CA 기업의 공개 키는 이미 브라우저가 알고 있습니다. 

> 생활 코딩<br>
> 브라우저는 내부적으로 CA의 리스트를 미리 파악하고 있다. 
> 이 말은 브라우저의 소스코드 안에 CA의 리스트가 들어있다는 것이다. 
> 브라우저가 미리 파악하고 있는 CA의 리스트에 포함되어야만 공인된 CA가 될 수 있는 것이다. 
> CA의 리스트와 함께 각 CA의 공개 키를 브라우저는 이미 알고 있다.

SSL 인증서를 발급해준 CA가 공인되었는지 아닌지에 따라 아래와 같은 이미지를 브라우저에서 확인할 수 있습니다.

##### CA 공인 여부에 따른 브라우저 메세지
<p align="center"><img src="/images/https-5.JPG" width="80%"></p>
<center>이미지 출처, https://opentutorials.org/course/228/4894</center><br>

##### SSL 인증서 발급 과정
1. 서비스 기업은 자신의 공개 키를 CA 기업에 전달하여 SSL 인증서 생성을 요청합니다.
1. CA 기업은 자신의 비공개 키로 서비스 기업의 공개 키와 함께 몇 가지 정보를 함께 암호화합니다.
1. 생성한 SSL 인증서를 서비스 기업에게 전달합니다.

<p align="center"><img src="/images/https-6.JPG" width="80%"></p>

##### 서버-클라이언트 SSL 인증서 전달 과정
1. 클라이언트(브라우저)가 서버에게 데이터 요청을 합니다.
1. 서버는 클라이언트에게  SSL 인증서를 전달합니다.
1. 클라이언트는 자신이 관리하는 공인된 CA 목록 중에 해당 SSL 인증서를 암호화한 CA가 있는지 확인합니다.
1. 목록에 존재하는 CA라면 클라이언트는 **이미 알고 있는 해당 CA의 공개 키**를 이용해 해당 인증서를 복호화합니다.

<p align="center"><img src="/images/https-7.JPG" width="80%"></p>

## HTTPS 통신 과정
작성 중 입니다.

## OPINION
작성 중 입니다.

#### REFERENCE
- [HTTPS의 원리][https-blog-link-1]
- <https://heidyhe.github.io/https/>
- <https://mysterico.tistory.com/30>
- <https://jeong-pro.tistory.com/89>
- <https://coding-start.tistory.com/208>
- <https://opentutorials.org/course/228/4894>
- <https://bravenamme.github.io/2019/07/04/https-1/>
- <https://bravenamme.github.io/2019/12/03/https-2/>

[http-blogLink]: https://junhyunny.github.io/information/http/
[https-blog-link-1]: https://velog.io/@moonyoung/HTTPS%EC%9D%98-%EC%9B%90%EB%A6%AC
[ca-wiki-link]: https://en.wikipedia.org/wiki/Certificate_authority